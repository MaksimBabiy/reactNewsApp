{"version":3,"sources":["../server/index.js","../server/parsePost.js","../server/config.js","actions/posts.js","actions/cities.js","components/Post.js","components/App.jsx","container/App.js","reducers/posts.js","reducers/cities.js","reducers/index.js","store.js","index.js"],"names":["_require","parseLinks","parsePost","getPosts","elems","fs","saveResult","json","to","writeFile","err","console","log","module","exports","createJson","then","links","scop","posts","JSON","stringify","catch","e","_regeneratorRuntime","_asyncToGenerator","unirest","cheerio","url","elem","Promise","resolve","reject","error","get","end","_ref","body","$","load","title","text","trim","domain","match","image","attr","indexOf","concat","next","time","_getPosts","mark","_callee","count","i","post","wrap","_context","prev","length","sent","push","abrupt","empty","stop","apply","this","arguments","className","maxLinks","undefined","_ref2","each","_x","_x2","setPosts","type","payload","changeCity","name","Post","style","backgroundImage","href","substr","App","props","axios","data","cities","city","items","onClick","bind","map","index","key","Component","connect","dispatch","bindActionCreators","postActions","cityActions","initialState","rootReducers","combineReducers","state","action","store","createStore","rootReducer","applyMiddleware","logger","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8b886360.chunk.js","sourcesContent":["var _require = require('./parsePost'),\n    parsePost = _require.parsePost,\n    parseLinks = _require.parseLinks,\n    getPosts = _require.getPosts;\n\nvar _require2 = require('./config'),\n    elems = _require2.elems;\n\nvar fs = require('fs');\n\nvar saveResult = function saveResult(json, to) {\n  fs.writeFile(to, json, function (err) {\n    if (err) console.log('Not saved');\n  });\n};\n\nvar createJson = function createJson() {\n  parseLinks('https://gordonua.com/regions/odessa.html', \".lenta_head a\", 20).then(function (links) {\n    getPosts(links, elems.scop).then(function (posts) {\n      return saveResult(JSON.stringify(posts, 0, 4), '../public/result.json');\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  }).catch(function (e) {\n    return console.log(e);\n  });\n  parseLinks('https://gordonua.com/news/kiev.html', \".lenta_head a\", 20).then(function (links) {\n    getPosts(links, elems.scop).then(function (posts) {\n      return saveResult(JSON.stringify(posts, 0, 4), '../public/result2.json');\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  }).catch(function (e) {\n    return console.log(e);\n  });\n  parseLinks('https://gordonua.com/news/worldnews.html', \".lenta_head a\", 20).then(function (links) {\n    getPosts(links, elems.scop).then(function (posts) {\n      return saveResult(JSON.stringify(posts, 0, 4), '../public/result3.json');\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  }).catch(function (e) {\n    return console.log(e);\n  });\n  console.log('newJson');\n};\n\nmodule.exports = {\n  createJson: createJson\n};","var _regeneratorRuntime = require(\"C:\\\\Users\\\\kitav\\\\Desktop\\\\work\\\\news\\\\src\\\\client\\\\news\\\\node_modules\\\\@babel\\\\runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"C:\\\\Users\\\\kitav\\\\Desktop\\\\work\\\\news\\\\src\\\\client\\\\news\\\\node_modules\\\\@babel\\\\runtime/helpers/asyncToGenerator\");\n\nvar unirest = require('unirest');\n\nvar cheerio = require('cheerio');\n\nvar log = function log(i, count, ms) {\n  return new Promise(function (r) {\n    return setTimeout(function () {\n      console.log(\"\\u0418\\u043D\\u0434\\u0435\\u043A\\u0441: \".concat(i, \"\\n            \\u0412\\u0441\\u0435\\u0433\\u043E \\u0437\\u0430\\u043F\\u0438\\u0441\\u0435\\u0439: \").concat(count));\n      r();\n    }, ms);\n  });\n};\n\nfunction parsePost(url, elem) {\n  return new Promise(function (resolve, reject, error) {\n    unirest.get(url).end(function (_ref) {\n      var body = _ref.body;\n      if (error) reject(body);\n      var $ = cheerio.load(body);\n      var title = $(elem.title).text().trim();\n      var domain = url.match(/\\/\\/(.*?)\\//)[1];\n      var image = $(elem.image).attr('src');\n      image = image.indexOf('https') >= 0 ? image : \"https://\".concat(domain).concat(image);\n      var text = $(elem.text).text().trim();\n      var next = url;\n      var time = $(elem.time).text();\n      var post = {\n        title: title,\n        image: image,\n        text: text,\n        next: next,\n        time: time\n      };\n      resolve(post);\n    });\n  });\n}\n\nfunction parseLinks(url, className) {\n  var maxLinks = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 3;\n  return new Promise(function (resolve, reject, error) {\n    var links = [];\n    unirest.get(url).end(function (_ref2) {\n      var body = _ref2.body;\n      if (error) reject(body);\n      var $ = cheerio.load(body);\n      var domain = url.match(/\\/\\/(.*?)\\//)[1];\n      $(className).each(function (i, e) {\n        if (i + 1 <= maxLinks) links.push('https://' + domain + $(e).attr('href'));\n      });\n      resolve(links);\n    });\n  });\n}\n\nfunction getPosts(_x, _x2) {\n  return _getPosts.apply(this, arguments);\n}\n\nfunction _getPosts() {\n  _getPosts = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(links, elem) {\n    var posts, count, i, post;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            posts = [];\n            count = links.length;\n            i = 0;\n\n          case 3:\n            if (!(i < count)) {\n              _context.next = 11;\n              break;\n            }\n\n            _context.next = 6;\n            return parsePost(links[i], elem).then(function (post) {\n              return post;\n            });\n\n          case 6:\n            post = _context.sent;\n            posts.push(post);\n\n          case 8:\n            i++;\n            _context.next = 3;\n            break;\n\n          case 11:\n            return _context.abrupt(\"return\", new Promise(function (resolve, reject) {\n              if (!posts.length) reject({\n                empty: 'empty'\n              });\n              resolve(posts);\n            }));\n\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getPosts.apply(this, arguments);\n}\n\nmodule.exports = {\n  parseLinks: parseLinks,\n  parsePost: parsePost,\n  getPosts: getPosts\n};","var elems = {\n  scop: {\n    title: '.a_head',\n    image: '.span-8 img',\n    text: '.block p',\n    time: '.flipboard-date'\n  }\n};\nmodule.exports = {\n  elems: elems\n};","export const setPosts = post => ({\r\n    type: 'SET_POST',\r\n    payload: post\r\n})","export const changeCity = name => ({\r\n    type: 'CHANGE_CITY',\r\n    payload: name\r\n})","import React from 'react';\r\n\r\n\r\nconst Post = ({title,text,image,next,time}) => {\r\n    return (\r\n        <div className=\"post\">\r\n            <div className=\"post__image\" style={{backgroundImage: `url(${image})` }}></div>\r\n            <div className=\"post__info\">\r\n            <h2 className=\"post__title\"><a href={next}>{title}</a></h2>\r\n            <p>{time}</p>\r\n                <p className=\"post__description\">\r\n                    {text.length >= 1800 ? text.substr(0,1800) : text}...\r\n                </p>\r\n            </div>\r\n        </div>\r\n      );\r\n}\r\n \r\nexport default Post;","import React,{Component} from 'react';\nimport Post from \"./Post\";\nimport axios from 'axios'\nimport {createJson} from '../../server/index'\n\nclass App extends Component{\n\n  UNSAFE_componentWillMount(){\n    const { setPosts } = this.props;\n    axios.get('result.json')\n    .then(({ data }) => setPosts(data))\n  }\n  componentDidUpdate(){\n    const { setPosts,cities } = this.props;\n    switch(cities.city){\n      case 'Odessa':\n          axios.get('result.json')\n          .then(({ data }) => setPosts(data))\n          break;\n      case 'Kiev': \n          axios.get('result2.json')\n          .then(({ data }) => setPosts(data)  )\n          break;\n      case 'World': \n      axios.get('result3.json')\n      .then(({ data }) => setPosts(data)  )\n          break;\n      default:\n          return false\n    }  \n  }\n  render(){\n    const { posts, changeCity } = this.props\n    const { items } = posts\n    \n    return (\n      <div>\n        <h1>Города</h1>\n        <h3>Выбранный город {this.props.cities.city}</h3>\n        <li>\n          <button onClick={changeCity.bind(this,'Odessa')}>Одесса</button>\n        </li>\n        <li>\n          <button onClick={changeCity.bind(this,'Kiev')}>Киев</button>\n        </li>\n        <li>\n          <button onClick={changeCity.bind(this,'World')}>Мир</button>\n        </li>\n        <button onClick={createJson}>Обновить новости</button>\n        {items.map((post,index)=> (\n          <Post {...post} key = {index}/>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default App\n","import * as postActions from '../actions/posts';\r\nimport * as cityActions from '../actions/cities';\r\nimport { bindActionCreators } from 'redux'\r\nimport { connect } from 'react-redux';\r\nimport App from '../components/App'\r\n\r\n\r\n\r\n\r\nconst mapStateToProps = (props) => ({\r\n   ...props\r\n});\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    ...bindActionCreators(postActions, dispatch),\r\n    ...bindActionCreators(cityActions, dispatch)\r\n})\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(App)","\r\nconst initialState = {\r\n    items: [],\r\n};\r\n\r\nexport default function(state = initialState, action) {\r\n    switch(action.type){\r\n        case 'SET_POST':\r\n            return {\r\n                ...state,\r\n                items: action.payload\r\n            };\r\n        case 'REMOVE_POST':\r\n            return {\r\n                ...state,\r\n            }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\n","const initialState = {\r\n    city: 'Odessa'\r\n};\r\n\r\nexport default function(state = initialState, action) {\r\n    switch(action.type){\r\n        case 'CHANGE_CITY':\r\n            return {\r\n                ...state,\r\n                city: action.payload\r\n            };\r\n        default:\r\n            return state\r\n    }\r\n}\r\n","import { combineReducers } from 'redux';\r\nimport posts from './posts'\r\nimport cities from './cities'\r\n\r\nconst rootReducers = combineReducers({\r\n    posts,\r\n    cities\r\n});\r\n\r\nexport default rootReducers","import { createStore,applyMiddleware } from 'redux';\r\nimport rootReducer from './reducers/index'\r\nimport logger from 'redux-logger'\r\nconst store = createStore(rootReducer,applyMiddleware(logger));\r\n\r\nexport default store","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './container/App';\nimport { Provider } from 'react-redux'\nimport store from './store'\nimport 'semantic-ui-css/semantic.min.css'\n\nReactDOM.render(\n<Provider store={store}>\n    <App />\n</Provider>\n, document.getElementById('root'));\n\n"],"sourceRoot":""}